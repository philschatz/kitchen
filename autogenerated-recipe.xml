<?xml version="1.0" encoding="UTF-8"?>
<!--This file is autogenerated. DO NOT EDIT.-->
<r:root xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://www.w3.org/1999/xhtml"
        xmlns:r="urn:replacer-xml">
   <r:replace selector="h:body">
      <r:declare>
         <r:bucket name="solutionBucket"/>
         <r:counter name="chapterCounter" selector="*[@data-type='chapter']"/>
      </r:declare>
      <r:this>
         <r:children/>
         <div data-type="composite-chapter"
              data-uuid-key=".solution"
              class="os-eob os-solution-container">
            <h1 data-type="document-title">
               <span class="os-text">Answer Key</span>
            </h1>
            <r:dump-bucket name="solutionBucket"
                           group-by="*[@data-type='chapter']"
                           group-by-title="./*[@data-type='document-title']"/>
         </div>
      </r:this>
      <r:replace selector="*[@data-type='chapter']">
         <r:declare>
            <r:link-text>Chapter <r:dump-counter name="chapterCounter"/>
            </r:link-text>
            <r:counter name="sectionCounter" selector="*[@data-type='page']"/>
            <r:counter name="exerciseCounter" selector="*[@data-type='exercise']"/>
            <r:counter name="figureCounter" selector="h:figure"/>
            <r:counter name="tableCounter" selector="h:table"/>
            <r:bucket name="iamapagebucket-key-equations"/>
            <r:bucket name="iamapagebucket-summary"/>
            <r:bucket name="iamapagebucket-exercises"/>
         </r:declare>
         <r:this>
            <h2>Chapter <r:dump-counter name="chapterCounter"/>
            </h2>
            <r:children/>
            <div data-type="page" data-uuid-key=".key-equations">
               <h2>Key Equations</h2>
               <r:dump-bucket name="iamapagebucket-key-equations"/>
            </div>
            <div data-type="page" data-uuid-key=".summary">
               <h2>Summary</h2>
               <r:dump-bucket name="iamapagebucket-summary"
                              group-by="*[@data-type='page']"
                              group-by-title="./*[@data-type='document-title']"/>
            </div>
            <div data-type="page" data-uuid-key=".exercises">
               <h2>Exercises</h2>
               <r:dump-bucket name="iamapagebucket-exercises"
                              group-by="*[@data-type='page']"
                              group-by-title="./*[@data-type='document-title']"/>
            </div>
         </r:this>
         <r:replace move-to="iamapagebucket-key-equations"
                    selector="*[@class='key-equations']"><!--TODO: BUG: Unwrap the section and remove the title-->
            <r:this h:data-todo="UNWRAPME">
               <r:children selector="node()[not(self::*[@data-type='title'])]"/>
            </r:this>
         </r:replace>
         <r:replace move-to="iamapagebucket-summary" selector="*[@class='summary']"><!--TODO: BUG: Unwrap the section and remove the title-->
            <r:this h:data-todo="UNWRAPME">
               <r:children selector="node()[not(self::*[@data-type='title'])]"/>
            </r:this>
         </r:replace>
         <r:replace move-to="iamapagebucket-exercises" selector="*[@class='exercises']"><!--TODO: BUG: Unwrap the section and remove the title-->
            <r:this h:data-todo="UNWRAPME">
               <r:children selector="node()[not(self::*[@data-type='title'])]"/>
            </r:this>
         </r:replace>
         <r:replace selector="*[@data-type='exercise'][*[@data-type='solution']]">
            <r:declare>
               <r:link-text>
                  <r:dump-counter name="chapterCounter"/>.<r:dump-counter name="exerciseCounter"/>
               </r:link-text>
            </r:declare>
            <r:this>
               <r:link to="child" selector="*[@data-type='solution']">
                  <r:dump-counter name="exerciseCounter"/>
               </r:link>
               <r:children/>
            </r:this>
            <r:replace move-to="solutionBucket" selector="*[@data-type='solution']">
               <r:this>
                  <r:link to="parent"/>
                  <r:children/>
               </r:this>
            </r:replace>
         </r:replace>
         <r:replace selector="*[@data-type='exercise'][not(*[@data-type='solution'])]">
            <r:declare>
               <r:link-text>
                  <r:dump-counter name="chapterCounter"/>.<r:dump-counter name="exerciseCounter"/>
               </r:link-text>
            </r:declare>
            <r:this>
               <strong>
                  <r:dump-counter name="exerciseCounter"/>
               </strong>
               <r:children/>
            </r:this>
         </r:replace>
         <r:replace selector="h:table">
            <div class="os-table">
               <div class="os-caption-container">
                  <h:span xmlns:g="urn:recipe-config-xml" class="os-title-label">Table </h:span>
                  <h:span xmlns:g="urn:recipe-config-xml" class="os-number">
                     <r:dump-counter name="chapterCounter"/>.<r:dump-counter name="tableCounter"/>
                  </h:span>
                  <h:span xmlns:g="urn:recipe-config-xml" class="os-divider"> </h:span>
                  <r:children selector="h:caption/node()"/>
               </div>
               <r:this h:class="top-titled">
                  <r:children selector="node()[not(self::h:caption)]"/>
               </r:this>
            </div>
         </r:replace>
         <r:replace selector="h:figure">
            <div class="os-figure">
               <div class="os-caption-container">
                  <r:children selector="h:figcaption"/>
               </div>
               <r:this>
                  <r:children selector="node()[not(self::h:figcaption)]"/>
               </r:this>
            </div>
            <r:replace selector="h:figcaption">
               <r:this>
                  <strong>
                     <h:span xmlns:g="urn:recipe-config-xml" class="os-title-label">Figure </h:span>
                     <h:span xmlns:g="urn:recipe-config-xml" class="os-number">
                        <r:dump-counter name="chapterCounter"/>.<r:dump-counter name="figureCounter"/>
                     </h:span>
                     <h:span xmlns:g="urn:recipe-config-xml" class="os-divider"> </h:span>
                  </strong>
                  <r:children/>
               </r:this>
            </r:replace>
         </r:replace>
         <r:replace selector="*[@data-type='note']" class="link-to-learning">
            <r:this h:class="os-note link-to-learning">
               <h:h6 data-type="title" class="os-note-title">Link to Learning</h:h6>
               <h:div class="os-note-body">
                  <r:children selector="*[not(@data-type='title')]"/>
               </h:div>
            </r:this>
         </r:replace>
         <r:replace selector="*[@data-type='note']" class="sciences-interconnect">
            <r:this h:class="os-note sciences-interconnect">
               <h:h6 data-type="title" class="os-note-title">How Sciences Interconnect</h:h6>
               <h:div class="os-note-body">
                  <r:children selector="*[not(@data-type='title')]"/>
               </h:div>
            </r:this>
         </r:replace>
         <r:replace selector="*[@data-type='note']" class="chemist-portrait">
            <r:this h:class="os-note chemist-portrait">
               <h:h6 data-type="title" class="os-note-title">Portrait of a Chemist</h:h6>
               <h:div class="os-note-body">
                  <r:children selector="*[not(@data-type='title')]"/>
               </h:div>
            </r:this>
         </r:replace>
         <r:replace selector="*[@data-type='note']" class="everyday-life">
            <r:this h:class="os-note everyday-life">
               <h:h6 data-type="title" class="os-note-title">Chemistry in Everyday Life</h:h6>
               <h:div class="os-note-body">
                  <r:children selector="*[not(@data-type='title')]"/>
               </h:div>
            </r:this>
         </r:replace>
         <r:replace selector="*[@data-type='page']">
            <r:declare>
               <r:link-text>
                  <r:copy-content selector="./*[@data-type='document-title']/node()"/>
               </r:link-text>
            </r:declare>
            <r:this>
               <r:children/>
            </r:this>
            <r:replace selector="*[@data-type='document-title']">
               <r:this>
                  <r:dump-counter name="chapterCounter"/>.<r:dump-counter name="sectionCounter"/>: <r:children/>
               </r:this>
            </r:replace>
         </r:replace>
      </r:replace>
   </r:replace>
</r:root>
